import{b as y,r as n,s as c,j as e}from"./index-TUPhGR7w.js";function b(){const{user:o,profile:s,organization:r,refreshProfile:f}=y(),[l,i]=n.useState(!1),[a,g]=n.useState(null),[d,h]=n.useState([]);n.useEffect(()=>{s?.org_id&&(x(),m())},[s]);const x=async()=>{try{const{data:t}=await c.from("ecount_connections").select("*").eq("org_id",s.org_id).eq("connection_name","primary").single();g(t)}catch(t){console.error("Ecount 상태 조회 실패:",t)}},m=async()=>{try{const{data:t}=await c.from("api_logs").select("*").eq("user_id",o?.id).order("created_at",{ascending:!1}).limit(10);h(t||[])}catch(t){console.error("로그 조회 실패:",t)}},u=async()=>{i(!0);try{(await c.functions.invoke("ensure-ecount-connection",{headers:{Authorization:`Bearer ${(await c.auth.getSession()).data.session?.access_token}`}})).data?.ok?(alert("Ecount 연결 테스트 성공!"),await x(),await m()):alert("Ecount 연결 테스트 실패")}catch(t){console.error("연결 테스트 실패:",t),alert(`연결 테스트 실패: ${t.message}`)}finally{i(!1)}},p=t=>{switch(t){case"active":return"text-green-600 bg-green-100";case"inactive":return"text-gray-600 bg-gray-100";case"error":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},j=t=>{switch(t){case"active":return"연결됨";case"inactive":return"비활성";case"error":return"오류";default:return"알 수 없음"}};return e.jsxs("div",{className:"max-w-4xl mx-auto py-8 px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"계정 설정"}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"계정 정보와 연결 상태를 확인하고 관리하세요"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-white shadow rounded-lg",children:e.jsxs("div",{className:"px-4 py-5 sm:p-6",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900 mb-4",children:"프로필 정보"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"이름"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:s?.full_name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"이메일"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:s?.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"휴대폰"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:s?.phone||"미등록"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"권한"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:s?.role==="owner"?"소유자":s?.role==="admin"?"관리자":"멤버"})]})]})]})}),e.jsx("div",{className:"bg-white shadow rounded-lg",children:e.jsxs("div",{className:"px-4 py-5 sm:p-6",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900 mb-4",children:"조직 정보"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"회사명"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:r?.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"업종"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:r?.industry||"미설정"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"생성일"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:r?.created_at?new Date(r.created_at).toLocaleDateString():"-"})]})]})]})}),e.jsx("div",{className:"bg-white shadow rounded-lg",children:e.jsxs("div",{className:"px-4 py-5 sm:p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Ecount 연결 상태"}),e.jsx("button",{onClick:u,disabled:l,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 whitespace-nowrap",children:l?"테스트 중...":"연결 테스트"})]}),a?e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"연결 상태"}),e.jsx("span",{className:`mt-1 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${p(a.status)}`,children:j(a.status)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"마지막 업데이트"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:new Date(a.updated_at).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"연결명"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:a.connection_name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Zone"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:a.zone||"기본"})]})]}):e.jsx("p",{className:"text-sm text-gray-500",children:"연결 정보를 불러오는 중..."})]})}),e.jsx("div",{className:"bg-white shadow rounded-lg",children:e.jsxs("div",{className:"px-4 py-5 sm:p-6",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900 mb-4",children:"최근 API 호출 로그"}),d.length>0?e.jsx("div",{className:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-300",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"함수명"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"상태"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"시간"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:d.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:t.fn}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${t.status===200?"text-green-800 bg-green-100":"text-red-800 bg-red-100"}`,children:t.status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(t.created_at).toLocaleString()})]},t.id))})]})}):e.jsx("p",{className:"text-sm text-gray-500",children:"최근 API 호출 기록이 없습니다."})]})})]})]})}export{b as default};
//# sourceMappingURL=account-I6k-U6eR.js.map
