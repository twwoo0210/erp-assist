{"version":3,"file":"page-BwirIM09.js","sources":["../../src/pages/chat/page.tsx"],"sourcesContent":["\nimport { useState, useRef, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { supabase } from '../../utils/supabase';\n\ninterface Message {\n  id: string;\n  type: 'user' | 'ai' | 'system';\n  content: string;\n  timestamp: string;\n  data?: any;\n}\n\ninterface ParsedOrder {\n  customer_name: string;\n  items: Array<{\n    item_name: string;\n    qty: number;\n    matched_item?: {\n      code: string;\n      name: string;\n      price: number;\n      unit?: string;\n    };\n    confidence?: number;\n  }>;\n}\n\nexport default function ChatPage() {\n  const navigate = useNavigate();\n  const [messages, setMessages] = useState<Message[]>([\n    {\n      id: '1',\n      type: 'system',\n      content: 'ÏïàÎÖïÌïòÏÑ∏Ïöî! ERP Assist AIÏûÖÎãàÎã§. ÏûêÏó∞Ïñ¥Î°ú Î∞úÏ£º ÎÇ¥Ïö©ÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî. Ïòà: \"AÍ±∞ÎûòÏ≤ò, ÍπêÏáºÏÉàÏö∞ 100Í∞ú, ÏÉàÏö∞Î≥º 50Í∞ú\"',\n      timestamp: new Date().toLocaleTimeString()\n    }\n  ]);\n  const [inputText, setInputText] = useState('');\n  const [isProcessing, setIsProcessing] = useState(false);\n  const [currentOrder, setCurrentOrder] = useState<ParsedOrder | null>(null);\n  const messagesEndRef = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    // SEOÏö© ÎèôÏ†Å Î©îÌÉÄÎç∞Ïù¥ÌÑ∞ ÏÑ§Ï†ï\n    document.title = 'AI Ï†ÑÌëúÏûÖÎ†• - ERP Assist | ÏûêÏó∞Ïñ¥Î°ú Í∞ÑÌé∏Ìïú Ï†ÑÌëú ÏÉùÏÑ±';\n    \n    const metaDescription = document.querySelector('meta[name=\"description\"]');\n    if (metaDescription) {\n      metaDescription.setAttribute('content', 'ÏûêÏó∞Ïñ¥Î°ú Í∞ÑÌé∏ÌïòÍ≤å Ï†ÑÌëúÎ•º ÏÉùÏÑ±ÌïòÏÑ∏Ïöî. AIÍ∞Ä Ï†ÑÌôî, Ïπ¥ÌÜ°, ÏóëÏÖÄ Ï£ºÎ¨∏ ÎÇ¥Ïö©ÏùÑ ÏûêÎèô Î∂ÑÏÑùÌïòÏó¨ Ïù¥Ïπ¥Ïö¥Ìä∏ ERP Ï†ÑÌëúÎ°ú Î≥ÄÌôòÌï©ÎãàÎã§.');\n    }\n\n    // Schema.org JSON-LD Ï∂îÍ∞Ä\n    const script = document.createElement('script');\n    script.type = 'application/ld+json';\n    script.textContent = JSON.stringify({\n      \"@context\": \"https://schema.org\",\n      \"@type\": \"WebPage\",\n      \"name\": \"AI Ï†ÑÌëúÏûÖÎ†•\",\n      \"description\": \"ÏûêÏó∞Ïñ¥Î°ú Í∞ÑÌé∏ÌïòÍ≤å Ï†ÑÌëúÎ•º ÏÉùÏÑ±ÌïòÎäî AI Í∏∞Î∞ò Ïù∏ÌÑ∞ÌéòÏù¥Ïä§\",\n      \"url\": `${window.location.origin}/chat`,\n      \"isPartOf\": {\n        \"@type\": \"WebSite\",\n        \"name\": \"ERP Assist\",\n        \"url\": window.location.origin\n      }\n    });\n    document.head.appendChild(script);\n\n    return () => {\n      const existingScript = document.querySelector('script[type=\"application/ld+json\"]');\n      if (existingScript && existingScript.parentNode) {\n        existingScript.parentNode.removeChild(existingScript);\n      }\n    };\n  }, []);\n\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  };\n\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  const addMessage = (type: 'user' | 'ai' | 'system', content: string, data?: any) => {\n    const newMessage: Message = {\n      id: Date.now().toString(),\n      type,\n      content,\n      timestamp: new Date().toLocaleTimeString(),\n      data\n    };\n    setMessages(prev => [...prev, newMessage]);\n  };\n\n  const callAIParseOrder = async (userInput: string) => {\n    try {\n      console.log('AI ÌååÏã± ÏãúÏûë:', userInput);\n      \n      const { data, error } = await supabase.functions.invoke('ai-parse-order', {\n        body: { inputText: userInput }\n      });\n\n      console.log('AI ÌååÏã± ÏùëÎãµ:', { data, error });\n\n      if (error) {\n        console.error('Supabase function error:', error);\n        throw new Error(error.message || 'AI ÌååÏã±Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.');\n      }\n\n      if (!data) {\n        throw new Error('AI ÌååÏã± Í≤∞Í≥ºÍ∞Ä ÏóÜÏäµÎãàÎã§.');\n      }\n\n      return data;\n    } catch (error: any) {\n      console.error('AI Parse Error:', error);\n      \n      // ÎÑ§Ìä∏ÏõåÌÅ¨ Ïò§Î•ò Ï≤òÎ¶¨\n      if (error.name === 'TypeError' && error.message.includes('fetch')) {\n        throw new Error('ÎÑ§Ìä∏ÏõåÌÅ¨ Ïó∞Í≤∞ÏùÑ ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî.');\n      }\n      \n      // ÌÉÄÏûÑÏïÑÏõÉ Ïò§Î•ò Ï≤òÎ¶¨\n      if (error.name === 'AbortError') {\n        throw new Error('ÏöîÏ≤≠ ÏãúÍ∞ÑÏù¥ Ï¥àÍ≥ºÎêòÏóàÏäµÎãàÎã§. Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.');\n      }\n      \n      throw new Error(error.message || 'AI ÌååÏã± Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.');\n    }\n  };\n\n  const simulateAIProcessing = async (userInput: string) => {\n    setIsProcessing(true);\n    let logId = null;\n    \n    try {\n      // Ï£ºÎ¨∏ Î°úÍ∑∏ Ï†ÄÏû• (ÏãúÏûë)\n      try {\n        const { data: { user } } = await supabase.auth.getUser();\n        \n        if (user) {\n          const { data: profile } = await supabase\n            .from('profiles')\n            .select('organization_id')\n            .eq('id', user.id)\n            .single();\n\n          if (profile?.organization_id) {\n            const { data: log } = await supabase\n              .from('order_logs')\n              .insert({\n                organization_id: profile.organization_id,\n                user_id: user.id,\n                raw_input_text: userInput,\n                status: 'pending'\n              })\n              .select()\n              .single();\n            \n            logId = log?.id;\n          }\n        }\n      } catch (logError) {\n        console.warn('Î°úÍ∑∏ Ï†ÄÏû• Ïã§Ìå®:', logError);\n        // Î°úÍ∑∏ Ï†ÄÏû• Ïã§Ìå®Ìï¥ÎèÑ Í≥ÑÏÜç ÏßÑÌñâ\n      }\n\n      const parsedOrder = await callAIParseOrder(userInput);\n      setCurrentOrder(parsedOrder);\n      addMessage('ai', 'AIÍ∞Ä Îã§ÏùåÍ≥º Í∞ôÏù¥ Î∂ÑÏÑùÌñàÏäµÎãàÎã§. ÎÇ¥Ïö©ÏùÑ ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî:', parsedOrder);\n      \n      // Ï£ºÎ¨∏ Î°úÍ∑∏ ÏóÖÎç∞Ïù¥Ìä∏ (ÏÑ±Í≥µ)\n      if (logId) {\n        try {\n          await supabase\n            .from('order_logs')\n            .update({\n              parsed_data: parsedOrder,\n              status: 'success'\n            })\n            .eq('id', logId);\n        } catch (logError) {\n          console.warn('Î°úÍ∑∏ ÏóÖÎç∞Ïù¥Ìä∏ Ïã§Ìå®:', logError);\n        }\n      }\n    } catch (error: any) {\n      console.error('AI Processing Error:', error);\n      addMessage('ai', `Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§: ${error.message}`);\n      \n      // Ï£ºÎ¨∏ Î°úÍ∑∏ ÏóÖÎç∞Ïù¥Ìä∏ (Ïã§Ìå®)\n      if (logId) {\n        try {\n          await supabase\n            .from('order_logs')\n            .update({\n              status: 'failed',\n              error_message: error.message\n            })\n            .eq('id', logId);\n        } catch (logError) {\n          console.warn('Î°úÍ∑∏ ÏóÖÎç∞Ïù¥Ìä∏ Ïã§Ìå®:', logError);\n        }\n      }\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  const handleConfirmOrder = async () => {\n    if (!currentOrder) return;\n    \n    setIsProcessing(true);\n    addMessage('system', 'Ïù¥Ïπ¥Ïö¥Ìä∏ ERPÏóê Ï†ÑÌëúÎ•º ÏÉùÏÑ±ÌïòÍ≥† ÏûàÏäµÎãàÎã§...');\n    \n    try {\n      const { data, error } = await supabase.functions.invoke('ecount-create-order', {\n        body: { orderData: currentOrder }\n      });\n\n      if (error) {\n        throw new Error(error.message || 'Ï†ÑÌëú ÏÉùÏÑ±Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.');\n      }\n\n      addMessage('ai', `Ï†ÑÌëúÍ∞Ä ÏÑ±Í≥µÏ†ÅÏúºÎ°ú ÏÉùÏÑ±ÎêòÏóàÏäµÎãàÎã§! Ï†ÑÌëúÎ≤àÌò∏: ${data?.orderNo || 'N/A'}`);\n      setCurrentOrder(null);\n      \n      // Ï£ºÎ¨∏ Î°úÍ∑∏Ïóê Ïù¥Ïπ¥Ïö¥Ìä∏ ÏùëÎãµ Ï†ÄÏû•\n      try {\n        const { data: { user } } = await supabase.auth.getUser();\n        if (user) {\n          const { data: profile } = await supabase\n            .from('profiles')\n            .select('organization_id')\n            .eq('id', user.id)\n            .single();\n\n          if (profile?.organization_id) {\n            // Í∞ÄÏû• ÏµúÍ∑º Î°úÍ∑∏ ÏóÖÎç∞Ïù¥Ìä∏\n            const { data: recentLog } = await supabase\n              .from('order_logs')\n              .select('id')\n              .eq('organization_id', profile.organization_id)\n              .eq('user_id', user.id)\n              .order('created_at', { ascending: false })\n              .limit(1)\n              .single();\n\n            if (recentLog) {\n              await supabase\n                .from('order_logs')\n                .update({\n                  ecount_response: data,\n                  status: 'success'\n                })\n                .eq('id', recentLog.id);\n            }\n          }\n        }\n      } catch (logError) {\n        console.warn('Î°úÍ∑∏ ÏóÖÎç∞Ïù¥Ìä∏ Ïã§Ìå®:', logError);\n      }\n    } catch (error: any) {\n      console.error('Order Creation Error:', error);\n      addMessage('ai', `Ï†ÑÌëú ÏÉùÏÑ±Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§: ${error.message}`);\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  const handleEditItem = (itemIndex: number, field: string, value: any) => {\n    if (!currentOrder) return;\n    \n    const updatedOrder = { ...currentOrder };\n    if (field === 'qty') {\n      updatedOrder.items[itemIndex].qty = parseInt(value) || 0;\n    }\n    setCurrentOrder(updatedOrder);\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!inputText.trim() || isProcessing) return;\n    \n    const userMessage = inputText.trim();\n    setInputText('');\n    addMessage('user', userMessage);\n    \n    await simulateAIProcessing(userMessage);\n  };\n\n  const renderMessage = (message: Message) => {\n    if (message.type === 'user') {\n      return (\n        <div key={message.id} className=\"flex justify-end mb-4\">\n          <div className=\"bg-blue-600 text-white rounded-lg px-4 py-2 max-w-xs lg:max-w-md\">\n            <p>{message.content}</p>\n            <p className=\"text-xs text-blue-100 mt-1\">{message.timestamp}</p>\n          </div>\n        </div>\n      );\n    }\n\n    if (message.type === 'system') {\n      return (\n        <div key={message.id} className=\"flex justify-center mb-4\">\n          <div className=\"bg-gray-100 text-gray-600 rounded-lg px-4 py-2 text-sm\">\n            {message.content}\n          </div>\n        </div>\n      );\n    }\n\n    return (\n      <div key={message.id} className=\"flex justify-start mb-4\">\n        <div className=\"bg-white border rounded-lg px-4 py-2 max-w-xs lg:max-w-2xl shadow-sm\">\n          <p className=\"mb-2\">{message.content}</p>\n          \n          {message.data && (\n            <div className=\"mt-4 p-4 bg-gray-50 rounded-lg\">\n              <h4 className=\"font-semibold text-gray-900 mb-3\">Ï£ºÎ¨∏ ÎÇ¥Ïó≠ ÌôïÏù∏</h4>\n              <div className=\"mb-3\">\n                <span className=\"text-sm text-gray-600\">Í±∞ÎûòÏ≤ò: </span>\n                <span className=\"font-medium\">{message.data.customer_name}</span>\n              </div>\n              \n              <div className=\"space-y-3\">\n                {message.data.items?.map((item: any, index: number) => (\n                  <div key={index} className=\"border border-gray-200 rounded-lg p-3 bg-white\">\n                    <div className=\"flex items-center justify-between mb-2\">\n                      <span className=\"font-medium text-gray-900\">\n                        {item.matched_item?.name || item.item_name}\n                      </span>\n                      {item.confidence && (\n                        <span className=\"text-xs text-gray-500\">\n                          Îß§Ïπ≠ÎèÑ: {Math.round(item.confidence * 100)}%\n                        </span>\n                      )}\n                    </div>\n                    <div className=\"grid grid-cols-3 gap-2 text-sm\">\n                      <div>\n                        <span className=\"text-gray-600\">ÌíàÎ™©ÏΩîÎìú: </span>\n                        <span className=\"font-mono\">{item.matched_item?.code || 'N/A'}</span>\n                      </div>\n                      <div>\n                        <span className=\"text-gray-600\">ÏàòÎüâ: </span>\n                        <input\n                          type=\"number\"\n                          value={item.qty}\n                          onChange={(e) => handleEditItem(index, 'qty', e.target.value)}\n                          className=\"w-16 px-1 py-0.5 border border-gray-300 rounded text-center\"\n                        />\n                        <span className=\"ml-1 text-xs text-gray-500\">{item.matched_item?.unit || 'Í∞ú'}</span>\n                      </div>\n                      <div>\n                        <span className=\"text-gray-600\">Îã®Í∞Ä: </span>\n                        <span className=\"font-medium\">‚Ç©{(item.matched_item?.price || 0).toLocaleString()}</span>\n                      </div>\n                    </div>\n                    <div className=\"mt-2 text-right text-sm font-medium text-blue-600\">\n                      ÏÜåÍ≥Ñ: ‚Ç©{((item.matched_item?.price || 0) * item.qty).toLocaleString()}\n                    </div>\n                  </div>\n                ))}\n              </div>\n              \n              <div className=\"mt-4 pt-3 border-t border-gray-200\">\n                <div className=\"text-right text-lg font-bold text-gray-900\">\n                  Ï¥ùÏï°: ‚Ç©{message.data.items?.reduce((total: number, item: any) => \n                    total + (item.matched_item?.price || 0) * item.qty, 0\n                  ).toLocaleString()}\n                </div>\n              </div>\n              \n              <div className=\"mt-4 flex gap-2\">\n                <button\n                  onClick={handleConfirmOrder}\n                  disabled={isProcessing}\n                  className=\"flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 disabled:opacity-50 cursor-pointer whitespace-nowrap\"\n                >\n                  {isProcessing ? 'Ï≤òÎ¶¨Ï§ë...' : 'Ï†ÑÌëú ÏÉùÏÑ±'}\n                </button>\n                <button\n                  onClick={() => setCurrentOrder(null)}\n                  className=\"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 cursor-pointer whitespace-nowrap\"\n                >\n                  Ï∑®ÏÜå\n                </button>\n              </div>\n            </div>\n          )}\n          \n          <p className=\"text-xs text-gray-500 mt-2\">{message.timestamp}</p>\n        </div>\n      </div>\n    );\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 flex flex-col\">\n      {/* Header */}\n      <header className=\"bg-white shadow-sm border-b\">\n        <div className=\"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <div className=\"flex justify-between items-center h-16\">\n            <div className=\"flex items-center space-x-4\">\n              <button \n                onClick={() => navigate('/dashboard')}\n                className=\"text-gray-600 hover:text-gray-900 cursor-pointer\"\n              >\n                <i className=\"ri-arrow-left-line text-xl\"></i>\n              </button>\n              <h1 \n                className=\"text-xl font-semibold text-gray-900 cursor-pointer\"\n                onClick={() => navigate('/')}\n              >\n                AI Ï†ÑÌëúÏûÖÎ†•\n              </h1>\n            </div>\n            <div className=\"flex items-center space-x-4\">\n              <span className=\"text-sm text-gray-500\">ERP Ïó∞ÎèôÎê®</span>\n              <div className=\"w-2 h-2 bg-green-500 rounded-full\"></div>\n            </div>\n          </div>\n        </div>\n      </header>\n\n      {/* Chat Messages */}\n      <div className=\"flex-1 overflow-y-auto\">\n        <div className=\"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-6\">\n          {messages.map((message) => renderMessage(message))}\n          <div ref={messagesEndRef} />\n        </div>\n      </div>\n\n      {/* Input Form */}\n      <div className=\"bg-white border-t\">\n        <div className=\"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-4\">\n          <form onSubmit={handleSubmit} className=\"flex gap-3\">\n            <input\n              type=\"text\"\n              value={inputText}\n              onChange={(e) => setInputText(e.target.value)}\n              placeholder=\"Ïòà: AÍ±∞ÎûòÏ≤ò, ÍπêÏáºÏÉàÏö∞ 100Í∞ú, ÏÉàÏö∞Î≥º 50Í∞ú\"\n              className=\"flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm\"\n              disabled={isProcessing}\n            />\n            <button\n              type=\"submit\"\n              disabled={!inputText.trim() || isProcessing}\n              className=\"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer whitespace-nowrap\"\n            >\n              {isProcessing ? (\n                <i className=\"ri-loader-4-line animate-spin\"></i>\n              ) : (\n                <i className=\"ri-send-plane-line\"></i>\n              )}\n            </button>\n          </form>\n          \n          <div className=\"mt-2 text-xs text-gray-500\">\n            üí° ÌåÅ: \"Í±∞ÎûòÏ≤òÎ™Ö, ÌíàÎ™©Î™Ö ÏàòÎüâ\" ÌòïÏãùÏúºÎ°ú ÏûÖÎ†•ÌïòÎ©¥ Îçî Ï†ïÌôïÌï©ÎãàÎã§\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":["ChatPage","navigate","useNavigate","messages","setMessages","useState","inputText","setInputText","isProcessing","setIsProcessing","currentOrder","setCurrentOrder","messagesEndRef","useRef","useEffect","metaDescription","script","existingScript","scrollToBottom","addMessage","type","content","data","newMessage","prev","callAIParseOrder","userInput","error","supabase","simulateAIProcessing","logId","user","profile","log","logError","parsedOrder","handleConfirmOrder","recentLog","handleEditItem","itemIndex","field","value","updatedOrder","handleSubmit","e","userMessage","renderMessage","message","jsxs","jsx","item","index","total"],"mappings":"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"}