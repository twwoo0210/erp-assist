{"version":3,"file":"account-I6k-U6eR.js","sources":["../../src/pages/settings/account.tsx"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport { useAuth } from '../../hooks/useAuth';\nimport { supabase } from '../../utils/supabase';\n\nexport default function AccountSettingsPage() {\n  const { user, profile, organization, refreshProfile } = useAuth();\n  const [loading, setLoading] = useState(false);\n  const [ecountStatus, setEcountStatus] = useState<any>(null);\n  const [recentLogs, setRecentLogs] = useState<any[]>([]);\n\n  useEffect(() => {\n    if (profile?.org_id) {\n      loadEcountStatus();\n      loadRecentLogs();\n    }\n  }, [profile]);\n\n  const loadEcountStatus = async () => {\n    try {\n      const { data } = await supabase\n        .from('ecount_connections')\n        .select('*')\n        .eq('org_id', profile.org_id)\n        .eq('connection_name', 'primary')\n        .single();\n\n      setEcountStatus(data);\n    } catch (error) {\n      console.error('Ecount 상태 조회 실패:', error);\n    }\n  };\n\n  const loadRecentLogs = async () => {\n    try {\n      const { data } = await supabase\n        .from('api_logs')\n        .select('*')\n        .eq('user_id', user?.id)\n        .order('created_at', { ascending: false })\n        .limit(10);\n\n      setRecentLogs(data || []);\n    } catch (error) {\n      console.error('로그 조회 실패:', error);\n    }\n  };\n\n  const testEcountConnection = async () => {\n    setLoading(true);\n    try {\n      const response = await supabase.functions.invoke('ensure-ecount-connection', {\n        headers: {\n          Authorization: `Bearer ${(await supabase.auth.getSession()).data.session?.access_token}`\n        }\n      });\n\n      if (response.data?.ok) {\n        alert('Ecount 연결 테스트 성공!');\n        await loadEcountStatus();\n        await loadRecentLogs();\n      } else {\n        alert('Ecount 연결 테스트 실패');\n      }\n    } catch (error: any) {\n      console.error('연결 테스트 실패:', error);\n      alert(`연결 테스트 실패: ${error.message}`);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case 'active': return 'text-green-600 bg-green-100';\n      case 'inactive': return 'text-gray-600 bg-gray-100';\n      case 'error': return 'text-red-600 bg-red-100';\n      default: return 'text-gray-600 bg-gray-100';\n    }\n  };\n\n  const getStatusText = (status: string) => {\n    switch (status) {\n      case 'active': return '연결됨';\n      case 'inactive': return '비활성';\n      case 'error': return '오류';\n      default: return '알 수 없음';\n    }\n  };\n\n  return (\n    <div className=\"max-w-4xl mx-auto py-8 px-4 sm:px-6 lg:px-8\">\n      <div className=\"mb-8\">\n        <h1 className=\"text-2xl font-bold text-gray-900\">계정 설정</h1>\n        <p className=\"mt-1 text-sm text-gray-600\">\n          계정 정보와 연결 상태를 확인하고 관리하세요\n        </p>\n      </div>\n\n      <div className=\"space-y-6\">\n        {/* 프로필 정보 */}\n        <div className=\"bg-white shadow rounded-lg\">\n          <div className=\"px-4 py-5 sm:p-6\">\n            <h3 className=\"text-lg leading-6 font-medium text-gray-900 mb-4\">\n              프로필 정보\n            </h3>\n            <div className=\"grid grid-cols-1 gap-4 sm:grid-cols-2\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700\">이름</label>\n                <p className=\"mt-1 text-sm text-gray-900\">{profile?.full_name}</p>\n              </div>\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700\">이메일</label>\n                <p className=\"mt-1 text-sm text-gray-900\">{profile?.email}</p>\n              </div>\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700\">휴대폰</label>\n                <p className=\"mt-1 text-sm text-gray-900\">{profile?.phone || '미등록'}</p>\n              </div>\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700\">권한</label>\n                <p className=\"mt-1 text-sm text-gray-900\">\n                  {profile?.role === 'owner' ? '소유자' : \n                   profile?.role === 'admin' ? '관리자' : '멤버'}\n                </p>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* 조직 정보 */}\n        <div className=\"bg-white shadow rounded-lg\">\n          <div className=\"px-4 py-5 sm:p-6\">\n            <h3 className=\"text-lg leading-6 font-medium text-gray-900 mb-4\">\n              조직 정보\n            </h3>\n            <div className=\"grid grid-cols-1 gap-4 sm:grid-cols-2\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700\">회사명</label>\n                <p className=\"mt-1 text-sm text-gray-900\">{organization?.name}</p>\n              </div>\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700\">업종</label>\n                <p className=\"mt-1 text-sm text-gray-900\">{organization?.industry || '미설정'}</p>\n              </div>\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700\">생성일</label>\n                <p className=\"mt-1 text-sm text-gray-900\">\n                  {organization?.created_at ? new Date(organization.created_at).toLocaleDateString() : '-'}\n                </p>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* Ecount 연결 상태 */}\n        <div className=\"bg-white shadow rounded-lg\">\n          <div className=\"px-4 py-5 sm:p-6\">\n            <div className=\"flex items-center justify-between mb-4\">\n              <h3 className=\"text-lg leading-6 font-medium text-gray-900\">\n                Ecount 연결 상태\n              </h3>\n              <button\n                onClick={testEcountConnection}\n                disabled={loading}\n                className=\"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 whitespace-nowrap\"\n              >\n                {loading ? '테스트 중...' : '연결 테스트'}\n              </button>\n            </div>\n\n            {ecountStatus ? (\n              <div className=\"grid grid-cols-1 gap-4 sm:grid-cols-2\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700\">연결 상태</label>\n                  <span className={`mt-1 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${getStatusColor(ecountStatus.status)}`}>\n                    {getStatusText(ecountStatus.status)}\n                  </span>\n                </div>\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700\">마지막 업데이트</label>\n                  <p className=\"mt-1 text-sm text-gray-900\">\n                    {new Date(ecountStatus.updated_at).toLocaleString()}\n                  </p>\n                </div>\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700\">연결명</label>\n                  <p className=\"mt-1 text-sm text-gray-900\">{ecountStatus.connection_name}</p>\n                </div>\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700\">Zone</label>\n                  <p className=\"mt-1 text-sm text-gray-900\">{ecountStatus.zone || '기본'}</p>\n                </div>\n              </div>\n            ) : (\n              <p className=\"text-sm text-gray-500\">연결 정보를 불러오는 중...</p>\n            )}\n          </div>\n        </div>\n\n        {/* 최근 API 호출 로그 */}\n        <div className=\"bg-white shadow rounded-lg\">\n          <div className=\"px-4 py-5 sm:p-6\">\n            <h3 className=\"text-lg leading-6 font-medium text-gray-900 mb-4\">\n              최근 API 호출 로그\n            </h3>\n            \n            {recentLogs.length > 0 ? (\n              <div className=\"overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg\">\n                <table className=\"min-w-full divide-y divide-gray-300\">\n                  <thead className=\"bg-gray-50\">\n                    <tr>\n                      <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                        함수명\n                      </th>\n                      <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                        상태\n                      </th>\n                      <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                        시간\n                      </th>\n                    </tr>\n                  </thead>\n                  <tbody className=\"bg-white divide-y divide-gray-200\">\n                    {recentLogs.map((log) => (\n                      <tr key={log.id}>\n                        <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900\">\n                          {log.fn}\n                        </td>\n                        <td className=\"px-6 py-4 whitespace-nowrap\">\n                          <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${\n                            log.status === 200 ? 'text-green-800 bg-green-100' : 'text-red-800 bg-red-100'\n                          }`}>\n                            {log.status}\n                          </span>\n                        </td>\n                        <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\n                          {new Date(log.created_at).toLocaleString()}\n                        </td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n            ) : (\n              <p className=\"text-sm text-gray-500\">최근 API 호출 기록이 없습니다.</p>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}"],"names":["AccountSettingsPage","user","profile","organization","refreshProfile","useAuth","loading","setLoading","useState","ecountStatus","setEcountStatus","recentLogs","setRecentLogs","useEffect","loadEcountStatus","loadRecentLogs","data","supabase","error","testEcountConnection","getStatusColor","status","getStatusText","jsxs","jsx","log"],"mappings":"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"}